<!DOCTYPE html>

<html>
<head>
  <title>todos.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>todos.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <h2 id="todo-model">Todo Model</h2>

            </div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>Our basic <strong>Todo</strong> model has <code>title</code> and <code>done</code> attributes.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">var</span> Todo = Backbone.Model.extend({</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>Default attributes for the Todo item.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  defaults: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> {
      title: <span class="hljs-string">""</span>,
      done: <span class="hljs-literal">false</span>
    };
  }

});</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <h2 id="todo-collection">Todo Collection</h2>

            </div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>The collection of Todos is backed by <em>localStorage</em> instead of a remote
server.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">var</span> TodoList = Backbone.Collection.extend({</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>Reference to this collection’s model.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  model: Todo,</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Save all of the todo items under the <code>&quot;todos-react&quot;</code> namespace.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  localStorage: <span class="hljs-keyword">new</span> Backbone.LocalStorage(<span class="hljs-string">"todos-react"</span>),</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>Filter down the list of all todo items that are finished.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  done: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.where({done: <span class="hljs-literal">true</span>});
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Filter down the list to only todo items that are still not finished.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  remaining: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.where({done: <span class="hljs-literal">false</span>});
  }

});</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <h2 id="backbone-react-integration">Backbone/React Integration</h2>

            </div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>Updates React components when their Backbone resources change. Expects the
component to implement a method called <code>getResource</code> that returns an object
that extends <code>Backbone.Events</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">var</span> BackboneMixin = {</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>Listen to all events on this component’s collection or model and force an
update when they fire. Let React decide whether the DOM should change.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  componentDidMount: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">this</span>._boundForceUpdate = <span class="hljs-keyword">this</span>.forceUpdate.bind(<span class="hljs-keyword">this</span>, <span class="hljs-literal">null</span>);
    <span class="hljs-keyword">this</span>.getResource().on(<span class="hljs-string">"all"</span>, <span class="hljs-keyword">this</span>._boundForceUpdate, <span class="hljs-keyword">this</span>);
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>Clean up the listener when the component will be removed.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  componentWillUnmount: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">this</span>.getResource().off(<span class="hljs-string">"all"</span>, <span class="hljs-keyword">this</span>._boundForceUpdate);
  }

};</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <h2 id="todo-list-item-component">Todo List Item Component</h2>

            </div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>The DOM for a todo item…</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">var</span> TodoListItemComponent = React.createClass({</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>If the component updates and is in edit mode, send focus to the <code>&lt;input&gt;</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  componentDidUpdate: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(prevProps)</span> </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.props.editing &amp;&amp; !prevProps.editing) {
      <span class="hljs-keyword">this</span>.refs.editInput.getDOMNode().focus();
    }
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>Destroying the model fires a <code>remove</code> event on the model’s collection,
which forces an update and removes this <strong>TodoListItemComponent</strong> from the
DOM. We don’t have to do any other cleanup!</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  destroy: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">this</span>.props.model.destroy();
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>Stop editing if the input gets an “Enter” keypress.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  handleEditKeyPress: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(event)</span> </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-number">13</span> === event.keyCode) {
      <span class="hljs-keyword">this</span>.stopEditing();
    }
  },

  render: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">var</span> inputStyles = {};
    <span class="hljs-keyword">var</span> viewStyles = {};</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>Hide the <code>.view</code> when editing</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.props.editing) {
      viewStyles.display = <span class="hljs-string">"none"</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>… and hide the <code>&lt;input&gt;</code> when not editing</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    } <span class="hljs-keyword">else</span> {
      inputStyles.display = <span class="hljs-string">"none"</span>;
    }

    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">li</span> <span class="hljs-attribute">className</span>=<span class="hljs-value">{this.props.model.get("done")</span> ? "<span class="hljs-attribute">done</span>" <span class="hljs-attribute">:</span> ""}&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">className</span>=<span class="hljs-value">"view"</span> <span class="hljs-attribute">onDoubleClick</span>=<span class="hljs-value">{this.startEditing}</span> <span class="hljs-attribute">style</span>=<span class="hljs-value">{viewStyles}</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">className</span>=<span class="hljs-value">"toggle"</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"checkbox"</span>
            <span class="hljs-attribute">checked</span>=<span class="hljs-value">{this.props.model.get("done")}</span>
            <span class="hljs-attribute">onChange</span>=<span class="hljs-value">{this.toggleDone}</span> /&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">label</span>&gt;</span>{this.props.model.get("title")}<span class="hljs-tag">&lt;/<span class="hljs-title">label</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">className</span>=<span class="hljs-value">"destroy"</span> <span class="hljs-attribute">onClick</span>=<span class="hljs-value">{this.destroy}</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">className</span>=<span class="hljs-value">"edit"</span> <span class="hljs-attribute">ref</span>=<span class="hljs-value">"editInput"</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text"</span>
          <span class="hljs-attribute">onBlur</span>=<span class="hljs-value">{this.stopEditing}</span>
          <span class="hljs-attribute">onChange</span>=<span class="hljs-value">{this.setTitle}</span>
          <span class="hljs-attribute">onKeyPress</span>=<span class="hljs-value">{this.handleEditKeyPress}</span>
          <span class="hljs-attribute">style</span>=<span class="hljs-value">{inputStyles}</span>
          <span class="hljs-attribute">value</span>=<span class="hljs-value">{this.props.model.get("title")}</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-title">li</span>&gt;</span>
    );
  },

</span></pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>Set the title of this item’s model when the value of the <code>&lt;input&gt;</code> changes.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  setTitle: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(event)</span> </span>{
    <span class="hljs-keyword">this</span>.props.model.set(<span class="hljs-string">"title"</span>, event.target.value);
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>Tell the parent component this list item is entering edit mode.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  startEditing: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">this</span>.props.onStartEditing(<span class="hljs-keyword">this</span>.props.model.id);
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>Exit edit mode.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  stopEditing: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">this</span>.props.onStopEditing(<span class="hljs-keyword">this</span>.props.model.id);
  },

  toggleDone: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(event)</span> </span>{
    <span class="hljs-keyword">this</span>.props.model.set(<span class="hljs-string">"done"</span>, event.target.checked);
  }

});</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <h2 id="todo-list-component">Todo List Component</h2>

            </div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>Renders a list of todos.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">var</span> TodoListComponent = React.createClass({</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>Start with no list item in edit mode.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  getInitialState: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> {
      editingModelId: <span class="hljs-literal">null</span>
    };
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <p>When a <code>TodoListItemComponent</code> starts editing, it passes its model’s ID to
this callback. Setting the state triggers this component to re-render and
render that <code>TodoListItemComponent</code> in edit mode.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  setEditingModelId: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(modelId)</span> </span>{
    <span class="hljs-keyword">this</span>.setState({editingModelId: modelId});
  },

  unsetEditingModelId: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(modelId)</span> </span>{
    <span class="hljs-keyword">if</span> (modelId === <span class="hljs-keyword">this</span>.state.editingModelId) {
      <span class="hljs-keyword">this</span>.setState({editingModelId: <span class="hljs-literal">null</span>});
    }
  },

  render: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">ul</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"todo-list"</span>&gt;</span>
        {this.props.collection.map(function(model) {
</span></pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>Pass the <code>key</code> attribute[1] a unique ID so React can track the
elements properly.</p>
<p>[1] <a href="http://facebook.github.io/react/docs/multiple-components.html#dynamic-children">http://facebook.github.io/react/docs/multiple-components.html#dynamic-children</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="hljs-keyword">return</span> (
            <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">TodoListItemComponent</span>
              <span class="hljs-attribute">editing</span>=<span class="hljs-value">{this.state.editingModelId</span> =<span class="hljs-value">==</span> <span class="hljs-attribute">model.id</span>}
              <span class="hljs-attribute">key</span>=<span class="hljs-value">{model.id}</span>
              <span class="hljs-attribute">model</span>=<span class="hljs-value">{model}</span>
              <span class="hljs-attribute">onStartEditing</span>=<span class="hljs-value">{this.setEditingModelId}</span>
              <span class="hljs-attribute">onStopEditing</span>=<span class="hljs-value">{this.unsetEditingModelId}</span> /&gt;</span>
          );
        }, this)}
      <span class="hljs-tag">&lt;/<span class="hljs-title">ul</span>&gt;</span>
    );
  }

});

</span></pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <h2 id="footer-component">Footer Component</h2>

            </div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>The footer shows the total number of todos and how many are completed.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">var</span> FooterComponent = React.createClass({

  render: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">var</span> clearCompletedStyles = {};</pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <p>Hide the “Clear X completed items” button if there are no completed
items.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (<span class="hljs-number">0</span> === <span class="hljs-keyword">this</span>.props.itemsDoneCount) {
      clearCompletedStyles.display = <span class="hljs-string">"none"</span>;
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p>Clicking the “Clear X completed items” button calls the
“clearCompletedItems” function passed in on <code>props</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">footer</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"clear-completed"</span> <span class="hljs-attribute">style</span>=<span class="hljs-value">{clearCompletedStyles}</span>
            <span class="hljs-attribute">onClick</span>=<span class="hljs-value">{this.props.clearCompletedItems}</span>&gt;</span>
          Clear {this.props.itemsDoneCount} completed
          {1 === this.props.itemsDoneCount ? " item" : " items"}
        <span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">className</span>=<span class="hljs-value">"todo-count"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">b</span>&gt;</span>{this.props.itemsRemainingCount}<span class="hljs-tag">&lt;/<span class="hljs-title">b</span>&gt;</span>
          {1 === this.props.itemsRemainingCount ? " item" : " items"} left
        <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-title">footer</span>&gt;</span>
    );
  }

});

</span></pre></div></div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <h2 id="main-component">Main Component</h2>

            </div>
            
        </li>
        
        
        <li id="section-40">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-40">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-41">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-41">&#182;</a>
              </div>
              <p>The main component contains the list of todos and the footer.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">var</span> MainComponent = React.createClass({</pre></div></div>
            
        </li>
        
        
        <li id="section-42">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-42">&#182;</a>
              </div>
              <p>Tell the <strong>App</strong> to toggle the <em>done</em> state of all <strong>Todo</strong> items.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  toggleAllItemsCompleted: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(event)</span> </span>{
    <span class="hljs-keyword">this</span>.props.toggleAllItemsCompleted(event.target.checked);
  },

  render: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">var</span> style = {};</pre></div></div>
            
        </li>
        
        
        <li id="section-43">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-43">&#182;</a>
              </div>
              <p>Hide the “Mark all as complete” button and the footer if there are no
<strong>Todo</strong> items.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (<span class="hljs-number">0</span> === <span class="hljs-keyword">this</span>.props.collection.length) {
      style.display = <span class="hljs-string">"none"</span>;
    }

    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">section</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"main"</span> <span class="hljs-attribute">style</span>=<span class="hljs-value">{style}</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"toggle-all"</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"checkbox"</span>
          <span class="hljs-attribute">checked</span>=<span class="hljs-value">{0</span> =<span class="hljs-value">==</span> <span class="hljs-attribute">this.props.collection.remaining</span>()<span class="hljs-attribute">.length</span>}
          <span class="hljs-attribute">onChange</span>=<span class="hljs-value">{this.toggleAllItemsCompleted}</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">label</span> <span class="hljs-attribute">htmlFor</span>=<span class="hljs-value">"toggle-all"</span>&gt;</span>
          Mark all as complete
        <span class="hljs-tag">&lt;/<span class="hljs-title">label</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">TodoListComponent</span> <span class="hljs-attribute">collection</span>=<span class="hljs-value">{this.props.collection}</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">FooterComponent</span>
          <span class="hljs-attribute">clearCompletedItems</span>=<span class="hljs-value">{this.props.clearCompletedItems}</span>
          <span class="hljs-attribute">itemsRemainingCount</span>=<span class="hljs-value">{this.props.collection.remaining().length}</span>
          <span class="hljs-attribute">itemsDoneCount</span>=<span class="hljs-value">{this.props.collection.done().length}</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-title">section</span>&gt;</span>
    );
  }

});

var AppComponent = React.createClass({

</span></pre></div></div>
            
        </li>
        
        
        <li id="section-44">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-44">&#182;</a>
              </div>
              <p>Clear all done todo items, destroying their models.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  clearCompletedItems: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    _.invoke(<span class="hljs-keyword">this</span>.props.collection.done(), <span class="hljs-string">"destroy"</span>);
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-45">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-45">&#182;</a>
              </div>
              <p>Fetch Todos before the App is rendered to the DOM.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  componentWillMount: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">this</span>.props.collection.fetch();
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-46">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-46">&#182;</a>
              </div>
              <p>Start the app with a blank <code>&lt;input&gt;</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  getInitialState: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> {
      title: <span class="hljs-string">""</span>
    };
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-47">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-47">&#182;</a>
              </div>
              <p>Used by the <strong>BackboneMixin</strong> to watch for changes on this component’s
resource.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  getResource: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.props.collection;
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-48">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-48">&#182;</a>
              </div>
              <p>Set the state of the title when the <code>&lt;input&gt;</code> is changed.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  handleTitleChange: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(event)</span> </span>{
    <span class="hljs-keyword">this</span>.setState({title: event.target.value});
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-49">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-49">&#182;</a>
              </div>
              <p>If “Enter” is pressed in the main input field, it will submit the form.
Create a new <strong>Todo</strong> in <em>localStorage</em> and reset the title.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  handleTitleFormSubmit: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(event)</span> </span>{
    event.preventDefault();

    <span class="hljs-keyword">if</span> (<span class="hljs-string">""</span> === <span class="hljs-keyword">this</span>.state.title) <span class="hljs-keyword">return</span>;

    <span class="hljs-keyword">this</span>.props.collection.create({title: <span class="hljs-keyword">this</span>.state.title});
    <span class="hljs-keyword">this</span>.setState({title: <span class="hljs-string">""</span>});
  },

  toggleAllItemsCompleted: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(completed)</span> </span>{
    <span class="hljs-keyword">this</span>.props.collection.each(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(todo)</span> </span>{
      todo.save({<span class="hljs-string">"done"</span>: completed});
    });
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-50">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-50">&#182;</a>
              </div>
              <p>Force updates whenever this <strong>App</strong>‘s collection receives events.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  mixins: [BackboneMixin],

  render: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">header</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">h1</span>&gt;</span>Todos<span class="hljs-tag">&lt;/<span class="hljs-title">h1</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">form</span> <span class="hljs-attribute">onSubmit</span>=<span class="hljs-value">{this.handleTitleFormSubmit}</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">placeholder</span>=<span class="hljs-value">"What needs to be done?"</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text"</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"title"</span>
              <span class="hljs-attribute">onChange</span>=<span class="hljs-value">{this.handleTitleChange}</span>
              <span class="hljs-attribute">value</span>=<span class="hljs-value">{this.state.title}</span> /&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-title">form</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">header</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">MainComponent</span>
          <span class="hljs-attribute">clearCompletedItems</span>=<span class="hljs-value">{this.clearCompletedItems}</span>
          <span class="hljs-attribute">collection</span>=<span class="hljs-value">{this.props.collection}</span>
          <span class="hljs-attribute">toggleAllItemsCompleted</span>=<span class="hljs-value">{this.toggleAllItemsCompleted}</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
    );
  }
})

</span></pre></div></div>
            
        </li>
        
        
        <li id="section-51">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-51">&#182;</a>
              </div>
              <p>Create a new Todo collection and render the <strong>App</strong> into <code>#todoapp</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>React.render(
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">AppComponent</span> <span class="hljs-attribute">collection</span>=<span class="hljs-value">{new</span> <span class="hljs-attribute">TodoList</span>()} /&gt;</span>,
  document.getElementById("todoapp")
);

</span></pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
